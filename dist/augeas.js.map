{"version":3,"file":"augeas.js","sources":["../src/template-registry/TemplateSelector.js","../src/template-registry/TemplateSelectorBuilder.js","../src/template-registry/template-registry.js","../src/template-registry/index.js","../src/elements/ags-view.js"],"sourcesContent":["export default class TemplateSelector {\n    constructor() {\n        this.name = '';\n        this._matchers = [];\n    }\n}\n","import TemplateSelector from './TemplateSelector';\n\nexport default class TemplateSelectorBuilder {\n    constructor(registry) {\n        this._registry = registry;\n        this._selector = new TemplateSelector();\n    }\n\n    value(valueMatcher) {\n        this._selector._matchers.push(v => valueMatcher(v));\n\n        return this;\n    }\n\n    scope(scopeMatcher) {\n        this._selector._matchers.push((v, p, s) => scopeMatcher(s));\n\n        return this;\n    }\n\n    renders(fn) {\n        this._registry.push(this._selector, fn);\n        return this._registry;\n    }\n}\n","import TemplateSelectorBuilder from './TemplateSelectorBuilder';\n\nexport default class TemplateRegistry {\n    constructor() {\n        this._templates = [];\n    }\n\n    get count() {\n        return this._templates.length;\n    }\n\n    /**\n     *\n     * @returns {TemplateSelectorBuilder}\n     */\n    get when() {\n        return new TemplateSelectorBuilder(this);\n    }\n\n    getTemplate(value, scope) {\n        const selectedTemplate = this._templates.find(template =>\n            template.selector.matches(value, scope));\n\n        return {\n            render: selectedTemplate.templateFunc,\n            name: selectedTemplate.name || null,\n        };\n    }\n\n    push(selector, templateFuncOrResult, name) {\n        let templateFunc = templateFuncOrResult;\n\n        if (typeof templateFunc !== 'function') {\n            templateFunc = () => templateFuncOrResult;\n        }\n\n        this._templates.push({\n            selector,\n            templateFunc,\n            name,\n        });\n    }\n}\n","import TemplateRegistry from './template-registry';\n\nexport const ViewTemplates = new TemplateRegistry();\nexport const FormTemplates = new TemplateRegistry();\n","import { render } from 'lit-html/lib/lit-extended';\nimport { PropertyAccessors } from '@polymer/polymer/lib/mixins/property-accessors';\nimport { html } from 'lit-html';\nimport { ViewTemplates } from '../template-registry';\n\nfunction recurseTemplates(agsView, root) {\n    return (value) => {\n        let templateResult;\n        const template = ViewTemplates.getTemplate(\n            agsView.value,\n            agsView.templateScope,\n        );\n\n        if (template) {\n            if (root && template.name) {\n                agsView.setAttribute('data-template', template.name);\n            }\n\n            templateResult = template.render(recurseTemplates(agsView, false), value);\n        } else if (agsView.ignoreMissing) {\n            templateResult = '';\n        } else {\n            templateResult = html`Template not found`;\n            console.warn('Template not found for', agsView.value);\n        }\n\n        return templateResult;\n    };\n}\n\nexport default class AgsView extends PropertyAccessors(HTMLElement) {\n    constructor() {\n        super();\n\n        this.templateScope = null;\n        this.value = null;\n        this.ignoreMissing = false;\n    }\n\n    static get observedAttributes() {\n        return [\n            'value',\n            'templateScope',\n            'ignoreMissing',\n        ];\n    }\n\n    connectedCallback() {\n        this._enableProperties();\n    }\n\n    _propertiesChanged() {\n        this._render();\n    }\n\n    _render() {\n        if (this.value) {\n            if (!this.shadowRoot) {\n                this.attachShadow({ mode: 'open' });\n            }\n\n            const templateFunc = recurseTemplates(this, true);\n\n            render(templateFunc(this.value), this.shadowRoot);\n        }\n\n        this.dispatchEvent(new CustomEvent('ags-render'));\n    }\n}\n\nAgsView.createPropertiesForAttributes();\n\nwindow.customElements.define('ags-view', AgsView);\n"],"names":["TemplateSelector","name","_matchers","TemplateSelectorBuilder","registry","_registry","_selector","valueMatcher","push","v","scopeMatcher","p","s","fn","TemplateRegistry","_templates","count","length","when","value","scope","selectedTemplate","find","template","selector","matches","templateFunc","templateFuncOrResult","ViewTemplates","FormTemplates","recurseTemplates","agsView","root","templateResult","getTemplate","templateScope","setAttribute","render","ignoreMissing","html","warn","AgsView","PropertyAccessors","HTMLElement","observedAttributes","_enableProperties","_render","shadowRoot","attachShadow","mode","dispatchEvent","CustomEvent","createPropertiesForAttributes","window","customElements","define"],"mappings":"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"}